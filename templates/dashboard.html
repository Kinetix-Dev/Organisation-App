<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.20/index.global.min.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <style>
        body {
            background-image: url("https://images.pexels.com/photos/35743923/pexels-photo-35743923.jpeg");
            background-repeat: no-repeat;
            background-size: cover;
            background-position: center;
        }
    </style>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var calenderEl = document.getElementById('calendar-container');
            var calendar = new FullCalendar.Calendar(calenderEl, {
                initialView: 'dayGridMonth',
                headerToolbar: {
                    left: 'prev,next',
                    center: 'title',
                    right: ''
                },
                height: 350,
                themeSystem: 'bootstrap5'
            });
            calendar.render()
        });
        document.addEventListener('DOMContentLoaded', function () {
            flatpickr("#datepicker", {
                dateFormat: "Y-m-d", 
                allowInput: true
            });
            document.querySelector("#calendar-icon").addEventListener("click", function () {
                datepicker.open();
            });
        });
    </script>
</head>
<body>
    <div class="nav_bar">
        <nav class="navbar navbar-expand-lg bg-body-tertiary rounded-pill m-2 shadow-sm">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">Placid ðŸ•™</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Logout</a>
                    </li>
                </ul>
                </div>
            </div>
        </nav>
    </div>

    <div class="container py-5">
        <div class="g-4 row">
            <div class="col-lg-8">
                <div class="card shadow-sm border-0 rounded-4">
                    <div class="card-body p-4">
                        <h4 class="card-title mb-4">Your Tasks</h4> 
                        {% for task in tasks %}
                        <div class="d-flex justify-content-between align-items-center border-bottom py-2">
                            <div>
                                <strong>{{ task.title }}</strong>
                                <small class="text-muted">({{ task.task_type }})</small>
                            </div>
                            <div>
                                <span class="badge bg-info text-dark">{{ task.difficulty }}</span>
                                <a href="/delete-task/ {{ task.id }}" class="btn btn-sm btn-outline-danger ms-2">Delete</a>
                            </div>
                        </div>
                        {% else %}
                        <p class="text-muted">No Tasks Found. Add one!</p>
                        {% endfor %}
                    </div>
                </div>

                <div class="card shadow-sm border-0 rounded-4 my-4">
                    <div class="card-body p-4">
                        <h4 class="card-title mb-4">New Task</h4> 
                        <form action="/add_task" method="POST">
                            <div class="input-group mb-3">
                                <span class="input-group-text">Task Title</span>
                                <input type="text" class="form-control" name="title">
                            </div>
                            <div class="input-group mb-3">
                                <span class="input-group-text" id="basic-addon1">Difficulty</span>
                                <select class="form-select" aria-label="Task Difficulty" name="difficulty">
                                    <option selected>Task Difficulty</option>
                                    <option value="1">Easy</option>
                                    <option value="2">Medium</option>
                                    <option value="3">Hard</option>
                                </select>
                            </div>
                            <div class="input-group mb-3">
                                <span class="input-group-text" id="basic-addon1">Type</span>
                                <select class="form-select" aria-label="Task Type" name="task_type">
                                    <option selected>Task Type</option>
                                    <option value="1">Work</option>
                                    <option value="2">Personal</option>
                                    <option value="3">Fitness</option>
                                </select>
                            </div>
                            <div class="input-group mb-3">
                                <span class="input-group-text" id="basic-addon1">Due Date</span>
                                <input type="text" id="datepicker" class="form-control" name="due_date" placeholder="Select a date">
                            </div>
                            <div>
                                <button type="submit" class="btn btn-primary rounded-pill w-100">Add Task</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="card shadow-sm border-0 rounded-4  sticky-top" style="top: 20px;">
                    <div class="card-body p-4">
                        <h4 class="card-title mb-4">Filters</h4> 
                        <div class="d-flex flex-column gap-2">
                            <a href="/dashboard?filter=Work" class="btn btn-outline-primary rounded-pill">Work</a>
                            <a href="/dashboard?filter=Personal" class="btn btn-outline-secondary rounded-pill">Personal</a>
                            <a href="/dashboard?filter=Fitness" class="btn btn-outline-success rounded-pill">Fitness</a>
                        </div>
                    </div>
 
                    <div class="card-footer p-4">
                        <div class="container">
                            <h5 class="mb-3">Schedule</h5>
                            <div id="calendar-container"></div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </div>
    </div>
</body>
</html>